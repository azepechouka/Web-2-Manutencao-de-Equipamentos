<div class="container mt-4">
  <h2 class="mb-4">Efetuar Manutenção</h2>

  <!-- Carregando ou erro -->
  <div *ngIf="carregando" class="text-muted">Carregando dados...</div>
  <div *ngIf="erro" class="alert alert-danger">{{ erro }}</div>

  <!-- Detalhes da solicitação -->
  <div *ngIf="!carregando && solicitacao" class="detalhes-solicitacao mb-4">
    <h4 class="mb-3">Dados da Solicitação</h4>

    <p><strong>Descrição do Equipamento:</strong> {{ solicitacao.descricaoEquipamento || '—' }}</p>

    <p><strong>Categoria do Equipamento:</strong>
      {{ solicitacao.categoriaEquipamento?.descricao || '—' }}
    </p>

    <p><strong>Descrição do Problema:</strong> {{ solicitacao.descricaoProblema || '—' }}</p>

    <p><strong>Data da Solicitação:</strong> {{ solicitacao.criadoEm | date:'dd/MM/yyyy, HH:mm' }}</p>

    <h4 class="mt-4 mb-3">Dados do Cliente</h4>
    <p><strong>Nome do Cliente:</strong> {{ cliente?.nome || '—' }}</p>
    <p><strong>Email do Cliente:</strong> {{ cliente?.email || '—' }}</p>
    <p><strong>Telefone do Cliente:</strong> {{ cliente?.telefone || '—' }}</p>
  </div>

  <!-- Ações principais -->
  <div class="acoes mb-4" *ngIf="!carregando && solicitacao">
    <button class="btn btn-primary me-2" (click)="iniciarManutencao()">Efetuar Manutenção</button>
    <button class="btn btn-warning" (click)="redirecionarManutencao()">Redirecionar Manutenção</button>
  </div>

  <!-- Campos da manutenção -->
  <div *ngIf="exibirCamposManutencao" class="mt-4">
    <h4 class="mb-3">Dados da Manutenção</h4>

    <div class="mb-3">
      <label for="descricao-manutencao" class="form-label">Descrição da Manutenção:</label>
      <textarea id="descricao-manutencao" #descricaoManutencao class="form-control" rows="3"></textarea>
    </div>

    <div class="mb-3">
      <label for="orientacoes-cliente" class="form-label">Orientações para o Cliente:</label>
      <textarea id="orientacoes-cliente" #orientacoesCliente class="form-control" rows="3"></textarea>
    </div>

    <button
      class="btn btn-success"
      (click)="concluirManutencao(descricaoManutencao.value, orientacoesCliente.value)"
    >
      Concluir Manutenção
    </button>
  </div>

  <!-- Mensagem final -->
  <div *ngIf="mensagem" class="alert alert-info mt-4" [innerHTML]="mensagem"></div>
</div>
