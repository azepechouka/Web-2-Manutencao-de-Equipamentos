<div class="container mt-5">
    <div class="row justify-content-center">
      <div class="col-md-8">
        <div class="card">
          <div class="card-header">
            <h3>Nova Solicitação de Manutenção</h3>
          </div>
          <div class="card-body">
            <form [formGroup]="solicitacaoForm" (ngSubmit)="onSubmit()">

              <div class="row">
                <div class="col-md-12 mb-3">
                  <label for="descricaoEquipamento" class="form-label">Descrição do Equipamento</label>
                  <input type="text" id="descricaoEquipamento" formControlName="descricaoEquipamento" class="form-control" placeholder="Ex: Impressora HP LaserJet Pro">
                </div>
              </div>

              <div class="row">
                <div class="col-md-12 mb-3">
                  <label for="descricaoProblema" class="form-label">Descrição do Problema</label>
                  <textarea id="descricaoProblema" formControlName="descricaoProblema" class="form-control" rows="3" placeholder="Descreva detalhadamente o problema encontrado"></textarea>
                </div>
              </div>

              <div class="row">
                <div class="col-md-6 mb-3">
                  <label for="clienteId" class="form-label">ID do Cliente</label>
                  <input type="number" id="clienteId" formControlName="clienteId" class="form-control">
                </div>
                <div class="col-md-6 mb-3">
                  <label for="statusAtualId" class="form-label">Status Atual</label>
                  <input type="number" id="statusAtualId" formControlName="statusAtualId" class="form-control" value="1" readonly>
                </div>
              </div>

              <div class="row">
                <div class="col-md-6 mb-3">
                  <label for="equipamentoId" class="form-label">ID do Equipamento (Opcional)</label>
                  <input type="number" id="equipamentoId" formControlName="equipamentoId" class="form-control" placeholder="Deixe em branco se não souber">
                </div>
              </div>

              <div class="d-grid gap-2">
                <button type="submit" class="btn btn-primary" [disabled]="!solicitacaoForm.valid">Enviar Solicitação</button>
              </div>

            </form>

            <div *ngIf="mensagem" class="alert alert-success mt-3" role="alert">
              {{ mensagem }}
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="container mt-4" *ngIf="solicitacaoEnviada && orcamentoDisponivel">
    <div class="row justify-content-center">
      <div class="col-md-8">
        <div class="card">
          <div class="card-header">
            <h3>Revisar Orçamento da Solicitação</h3>
          </div>
          <div class="card-body">
            <div class="mb-3">
              <div class="d-flex justify-content-between">
                <div>
                  <div class="small text-muted">Solicitação</div>
                  <div class="fw-semibold">#{{ solicitacaoEnviada.id }}</div>
                </div>
                <div>
                  <div class="small text-muted">Criado em</div>
                  <div class="fw-semibold">{{ solicitacaoEnviada.criadoEm | date:'short' }}</div>
                </div>
              </div>
            </div>

            <div class="mb-3">
              <div class="small text-muted">Equipamento</div>
              <div class="fw-semibold">{{ solicitacaoEnviada.descricaoEquipamento }}</div>
            </div>

            <div class="mb-4">
              <div class="small text-muted">Descrição do Problema</div>
              <div>{{ solicitacaoEnviada.descricaoProblema }}</div>
            </div>

            <div class="orcamento-box mb-4">
              <div class="small text-muted">Valor Orçado</div>
              <div class="orcamento-preco">{{ orcamentoDisponivel.valorTotal | currency: 'BRL' : 'symbol' : '1.2-2' }}</div>
              <div class="text-muted" *ngIf="orcamentoDisponivel.observacao">{{ orcamentoDisponivel.observacao }}</div>
            </div>

            <div class="d-flex gap-2">
              <button class="btn btn-success" (click)="aprovarOrcamento()">Aprovar Serviço</button>
              <button class="btn btn-outline-danger" (click)="rejeitarOrcamento()">Rejeitar Serviço</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
