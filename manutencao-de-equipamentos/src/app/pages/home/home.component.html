<section class="container-fluid mt-4 px-4">
  <h2 class="mb-4 fw-semibold">Minhas Solicitações</h2>

  <!-- Estado de carregamento -->
  <div *ngIf="carregando" class="text-muted mb-2">Carregando…</div>

  <!-- Mensagem de erro -->
  <div *ngIf="erro" class="alert alert-danger mb-3">
    {{ erro }}
  </div>

  <!-- Tabela de solicitações -->
  <div *ngIf="!carregando && !erro && itens.length > 0; else vazio">
    <table class="table table-striped table-hover align-middle w-100 shadow-sm">
      <thead class="table-light text-center">
        <tr>
          <th style="width: 12%">Data/Hora</th>
          <th style="width: 30%">Equipamento</th>
          <th style="width: 18%">Categoria</th>
          <th style="width: 15%">Status</th>
          <th style="width: 25%">Ações</th>
        </tr>
      </thead>

      <tbody>
        <tr *ngFor="let item of itens" class="text-center">
          <!-- Data -->
          <td>{{ item.criadoEm | date: 'dd/MM/yyyy, HH:mm' }}</td>

          <!-- Equipamento -->
          <td class="text-start" [title]="item.descricaoEquipamento">
            {{
              item.descricaoEquipamento.length > 30
                ? (item.descricaoEquipamento | slice: 0:30) + '…'
                : item.descricaoEquipamento
            }}
          </td>

          <!-- Categoria -->
          <td>{{ item.categoriaNome }}</td>

          <!-- Status -->
          <td>
            <span
              class="badge px-3 py-2"
              [ngStyle]="{
                backgroundColor: getStatusCor(item.estadoAtual),
                color: '#fff'
              }"
            >
              {{ item.estadoAtual }}
            </span>
          </td>

          <!-- Ações -->
          <td>
            <ng-container *ngIf="getAcoes(item) as acao">
              <button
                type="button"
                class="btn btn-sm"
                [ngClass]="acao.tipo"
                (click)="acao.acao()"
              >
                {{ acao.texto }}
              </button>
            </ng-container>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Template para lista vazia -->
  <ng-template #vazio>
    <p class="text-muted text-center mt-4">Nenhuma solicitação encontrada.</p>
  </ng-template>
</section>
