<section class="rf003 container-fluid mt-4 px-4">
  <h2 class="mb-4 fw-semibold">Minhas Solicitações</h2>

  <!-- Loading -->
  <div *ngIf="carregando" class="text-muted mb-2">Carregando…</div>

  <!-- Erro -->
  <div *ngIf="erro" class="alert alert-danger mb-3">
    {{ erro }}
  </div>

  <!-- Tabela de solicitações -->
  <div *ngIf="!carregando && !erro && itens.length > 0; else vazio">
    <table class="table table-striped table-hover align-middle w-100 shadow-sm">
      <thead class="table-light">
        <tr class="text-center">
          <th style="width: 12%">Data/Hora</th>
          <th style="width: 30%">Equipamento</th>
          <th style="width: 18%">Categoria</th>
          <th style="width: 15%">Status</th>
          <th style="width: 25%">Ações</th>
        </tr>
      </thead>

      <tbody>
        <tr *ngFor="let item of itens" class="text-center">
          <td>{{ item.criadoEm | date: 'dd/MM/yyyy, HH:mm' }}</td>

          <td class="text-start" [title]="item.descricaoEquipamento">
            {{
              item.descricaoEquipamento.length > 30
                ? (item.descricaoEquipamento | slice: 0:30) + '…'
                : item.descricaoEquipamento
            }}
          </td>

          <td>{{ item.categoriaNome }}</td>

          <td>
            <span
              class="badge px-3 py-2"
              [ngStyle]="{
                backgroundColor: getStatusCor(item.estadoAtual),
                color: '#fff'
              }"
            >
              {{ item.estadoAtual }}
            </span>
          </td>

          <td>
            <div class="d-flex justify-content-center gap-2">
              <button
                type="button"
                class="btn btn-sm btn-primary"
                (click)="verSolicitacao(item.id)"
              >
                Visualizar
              </button>

              <button
                type="button"
                class="btn btn-sm btn-success"
                (click)="abrirOrcamento(item.id)"
              >
                Abrir Orçamento
              </button>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Template para lista vazia -->
  <ng-template #vazio>
    <p class="text-muted text-center mt-4">Nenhuma solicitação encontrada.</p>
  </ng-template>
</section>
