<div class="container" style="max-width: 840px; margin: 0 auto; padding: 1rem;">
  <div class="card" style="padding: 1rem; border: 1px solid #ddd; border-radius: 8px;">
    <h3 style="margin: 0 0 1rem;">Filtro de Orçamentos por Período</h3>

    <form
      [formGroup]="filtro"
      (ngSubmit)="buscar()"
      class="row"
      style="display: grid; grid-template-columns: 1fr 1fr auto auto; gap: .5rem 1rem; align-items: end;"
    >
      <div>
        <label for="dataIni" style="display:block; font-weight:600; margin-bottom:.25rem;">Data inicial</label>
        <input id="dataIni" type="date" class="form-control" formControlName="dataIni" />
        <div *ngIf="filtro.controls.dataIni.touched && filtro.controls.dataIni.invalid"
             style="color:#c00; font-size:.9rem; margin-top:.25rem;">
          Informe a data inicial.
        </div>
      </div>

      <div>
        <label for="dataFim" style="display:block; font-weight:600; margin-bottom:.25rem;">Data final</label>
        <input id="dataFim" type="date" class="form-control" formControlName="dataFim" />
        <div *ngIf="filtro.controls.dataFim.touched && filtro.controls.dataFim.invalid"
             style="color:#c00; font-size:.9rem; margin-top:.25rem;">
          Informe a data final.
        </div>
      </div>

      <button type="submit" [disabled]="buscando() || filtro.invalid" class="btn btn-primary" style="height: 38px;">
        Buscar
      </button>

      <button type="button" (click)="limpar()" class="btn btn-outline-secondary" style="height: 38px;">
        Limpar
      </button>

      <button type="button"
        class="btn btn-outline-primary"
        style="height: 38px;"
        (click)="exportarPDF()">
        Exportar PDF
      </button>
    </form>
  </div>
  <div *ngIf="currentData().length" class="card"
       style="margin-top: .75rem; padding: .75rem; border:1px solid #e5e5e5; border-radius:8px; background:#fafafa;">
    <strong>Resumo:</strong>
    <span style="margin-left:.5rem;">
      {{ totalCount() }} orçamento(s)
    </span>
    <span style="margin-left:1rem;">
      Total: <strong>{{ totalValor() | currency:'BRL':'symbol':'1.2-2' }}</strong>
    </span>
  </div>
  <div class="resultados" style="margin-top: 1rem;">
    <ng-container *ngIf="resultados$ | async as itens">
      <div *ngIf="!itens.length" style="color:#666;">Nenhum resultado para exibir.</div>

      <div *ngFor="let o of itens; trackBy: trackById" class="item"
           style="border:1px solid #eee; border-radius:8px; padding:.75rem; margin-bottom:.5rem;">
        <div style="display:flex; justify-content:space-between; gap:1rem; flex-wrap:wrap;">
          <div>
            <strong>#{{ o.id }}</strong>
            <div>Solicitação: {{ o.solicitacaoId }}</div>
          </div>
          <div>
            <div>Valor: <strong>{{ o.valorTotal | currency:o.moeda:'symbol':'1.2-2' }}</strong></div>
            <div>Data: {{ o.criadoEm | date:'dd/MM/yyyy HH:mm' }}</div>
          </div>
        </div>
        <div *ngIf="o.observacao" style="margin-top:.25rem; color:#555;">
          Obs.: {{ o.observacao }}
        </div>
      </div>
    </ng-container>
  </div>
</div>
