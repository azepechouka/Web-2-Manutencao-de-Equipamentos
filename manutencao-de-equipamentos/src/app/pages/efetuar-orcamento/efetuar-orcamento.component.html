<div class="container" style="max-width: 980px; margin: 0 auto; padding: 1rem;">
  <div *ngIf="carregando()" class="text-muted">Carregando…</div>
  <div *ngIf="erro()" class="text-danger">{{ erro() }}</div>

  <ng-container *ngIf="!carregando() && detalhe() as d">
    <div class="card" style="margin-bottom: 1rem; border:1px solid #e5e5e5; border-radius:8px;">
      <div class="card-header" style="padding:.75rem 1rem; background:#f7f7f7;">
        <strong>Dados da Solicitação</strong>
      </div>
      <div class="card-body" style="padding: .75rem 1rem;">
        <div><strong>ID:</strong> {{ d.id }}</div>
        <div><strong>Aberta em:</strong> {{ d.criadoEm | date:'short' }}</div>
        <div><strong>Status atual:</strong> {{ d.statusAtualNome }}</div>
        <div style="margin-top:.5rem;">
          <strong>Equipamento:</strong> {{ d.descricaoEquipamento }}
        </div>
        <div style="margin-top:.25rem; white-space: pre-line;">
          <strong>Problema relatado:</strong> {{ d.descricaoProblema }}
        </div>
      </div>
    </div>

    <div class="card" style="margin-bottom: 1rem; border:1px solid #e5e5e5; border-radius:8px;">
      <div class="card-header" style="padding:.75rem 1rem; background:#f7f7f7;">
        <strong>Dados do Cliente</strong>
      </div>
      <div class="card-body" style="padding: .75rem 1rem;" *ngIf="cliente() as c; else semCliente">
        <div><strong>Nome:</strong> {{ c.nome }}</div>
        <div><strong>E-mail:</strong> {{ c.email }}</div>
        <div><strong>Telefone:</strong> {{ c.telefone }}</div>
        <div *ngIf="c.endereco">
          <strong>Endereço:</strong>
          {{ c.endereco.logradouro }}, {{ c.endereco.numero }}
          <span *ngIf="c.endereco.complemento"> - {{ c.endereco.complemento }}</span>,
          {{ c.endereco.bairro }} - {{ c.endereco.localidade }}/{{ c.endereco.uf }}
          — CEP: {{ c.endereco.cep }}
        </div>
      </div>
      <ng-template #semCliente>
        <div class="card-body text-muted" style="padding: .75rem 1rem;">Cliente não encontrado.</div>
      </ng-template>
    </div>

    <div class="card" style="border:1px solid #e5e5e5; border-radius:8px;">
      <div class="card-header" style="padding:.75rem 1rem; background:#f7f7f7;">
        <strong>Efetuar Orçamento (RF012)</strong>
      </div>
      <div class="card-body" style="padding: .75rem 1rem;">
        <form [formGroup]="form" (ngSubmit)="salvar()" class="row" style="display:grid; grid-template-columns: 240px 1fr auto; gap: .75rem 1rem; align-items:end;">
          <div>
            <label class="form-label" for="valorTotal">Valor</label>
            <input id="valorTotal" type="number" min="0.01" step="0.01" formControlName="valorTotal" class="form-control" placeholder="0,00" />
            <small class="text-danger" *ngIf="form.controls.valorTotal.touched && form.controls.valorTotal.invalid">
              Informe um valor maior que zero.
            </small>
          </div>

          <div>
            <label class="form-label" for="observacao">Observação (opcional)</label>
            <input id="observacao" type="text" formControlName="observacao" class="form-control" placeholder="Ex.: peças incluídas, mão de obra, etc." />
          </div>

          <button type="submit" class="btn btn-primary" [disabled]="form.invalid">Registrar Orçamento</button>
        </form>
      </div>
    </div>
  </ng-container>
</div>
